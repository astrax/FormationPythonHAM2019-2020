<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="TD N°4 : Intégration numérique">

<title>TD N°4 : Intégration numérique</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_journal */
  margin:-60px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Table des matières',
               2,
               'table_of_contents',
               'table_of_contents'),
              ('Exercise 1: Valeur approchée de $\\pi$', 2, None, '___sec0'),
              ('Exercise 2: Intégration adaptative',
               2,
               'ex:adaptatif',
               'ex:adaptatif'),
              ('Remarks', 3, None, '___sec2'),
              ('Exercise 3: Intégration de x élevé à x', 2, None, '___sec3')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="TD4.html">TD N°4 : Intégration numérique</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contenu <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#table_of_contents" style="font-size: 80%;"><b>Table des matières</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 80%;"><b>Exercise 1: Valeur approchée de \( \pi \)</b></a></li>
     <!-- navigation toc: --> <li><a href="#ex:adaptatif" style="font-size: 80%;"><b>Exercise 2: Intégration adaptative</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#___sec3" style="font-size: 80%;"><b>Exercise 3: Intégration de x élevé à x</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>TD N&#176;4 : Int&#233;gration num&#233;rique</h1></center>  <!-- document title -->

<p>
<!-- author(s): Ahmed Ammar -->

<center>
<b>Ahmed Ammar</b>  (<tt>ahmed.ammar at fst.utm.tn</tt>)
</center>

<p>
<!-- institution -->

<center><b>Institut Pr&#233;paratoire aux &#201;tudes Scientifiques et Techniques, Universit&#233; de Carthage.</b></center>
<br>
<p>
<center><h4>Jan 14, 2020</h4></center> <!-- date -->
<br>
<p>
</div> <!-- end jumbotron -->

<h1 id="table_of_contents">Table des matières</h2>

<p>
<a href="#___sec0"> Exercise 1: Valeur approch&#233;e de \( \pi \) </a><br>
<a href="#ex:adaptatif"> Exercise 2: Int&#233;gration adaptative </a><br>
<a href="#___sec3"> Exercise 3: Int&#233;gration de x &#233;lev&#233; &#224; x </a><br>
</p>
<p>
<!-- !split -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec0" class="anchor">Exercise 1: Valeur approch&#233;e de \( \pi \) </h2>

<p>
&#201;tant donn&#233;e l'&#233;galit&#233;:
$$
\begin{equation}
\pi = 4 \left( \int_0^\infty e^{-x^2} dx \right)^2 = 4 \left( \int_0^{10} e^{-x^2} dx + \epsilon \right)^2
\label{_auto1}
\end{equation}
$$

avec \( 0 < \epsilon < 10^{&#8722;44} \) , utiliser la m&#233;thode des trap&#232;zes composite &#224; \( 10 \) intervalles pour estimer la valeur de \( \pi \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_1_1" style="font-size: 80%;"></a>
<a href="#exer_1_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_1_1">

<p>
La m&#233;thode des trap&#232;zes composite &#224; \( n \) intervalles pour calculer l&#8217;int&#233;grale d&#8217;une fonction f sur l&#8217;intervalle \( [a, b] \) s&#8217;&#233;crit
$$
\begin{equation*}
\int_a^b f(x)\,dx \approx h \left[\frac{1}{2}f(x_0) + \sum_{i=1}^{n-1}f(x_i) + \frac{1}{2}f(x_n) \right]
\end{equation*}
$$

avec \( h = \frac{b-a}{n} \) et \( x_i = a + ih,\quad i = 0,1,\ldots,n \)

<p>
Ici on a \( f (x) = e^{-x} \) , \( a = 0 \), \( b = 10 \), \( n = 10 \) d&#8217;o&#249; \( h = 1 \) et on obtient
$$
\begin{equation*}
I \approx \frac{1}{2} + \sum_{i=1}^{9} e^{-i} + \frac{1}{2e^{100}} = \frac{1}{2} + \frac{1}{e} + \frac{1}{e^{4}} + \frac{1}{e^{9}} + \frac{1}{e^{16}} + \frac{1}{e^{25}} + \frac{1}{e^{36}} + \frac{1}{e^{49}} + \frac{1}{e^{64}} + \frac{1}{e^{81}} + \frac{1}{2e^{100}}
\end{equation*}
$$

ainsi en utilisant la fonction <code>trapeze(f,a,b,n)</code> du module <code>trapeze_integral.py</code> d&#233;crite dans le cours comme suit
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">trapeze_integral</span> <span style="color: #008000; font-weight: bold">import</span> trapeze
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp
f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: exp(<span style="color: #666666">-</span>x<span style="color: #666666">**2</span>)
I <span style="color: #666666">=</span> trapeze(f, <span style="color: #666666">0</span>, <span style="color: #666666">10</span>, <span style="color: #666666">10</span>)
<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #666666">4*</span>I<span style="color: #666666">**2</span>)
</pre></div>
<p>
on obtient \( \pi \approx 4I^2 = 3.14224265994 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- !split -->

<p>
<!-- --- begin exercise --- -->

<h2 id="ex:adaptatif" class="anchor">Exercise 2: Int&#233;gration adaptative</h2>

<p>
Supposons que nous voulons utiliser la m&#233;thode des trap&#232;zes ou du point milieu pour calculer une int&#233;grale \( \int_a^b f(x)dx \) avec une erreur inf&#233;rieure &#224; une tol&#233;rance prescrite \( \epsilon \). Quelle est la taille appropri&#233;e de \( n \)?

<p>
Pour r&#233;pondre &#224; cette question, nous pouvons entrer une proc&#233;dure it&#233;rative o&#249; nous comparons les r&#233;sultats produits par \( n \) et \( 2n \) intervalles, et si la diff&#233;rence est inf&#233;rieure &#224; \( \epsilon \), la valeur correspondant &#224; \( 2n \) est retourn&#233;e. Sinon, nous avons \( n \) et r&#233;p&#233;tons la proc&#233;dure.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_1" style="font-size: 80%;"></a>
<a href="#exer_2_1" data-toggle="collapse">
<b>Indication.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_1">

<p>
Il peut &#234;tre une bonne id&#233;e d'organiser votre code afin que la fonction <code>integration_adaptive</code> peut &#234;tre utilis&#233; facilement dans les programmes futurs que vous &#233;crivez.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>a)</b>
&#201;crire une fonction <code>integration_adaptive(f, a, b, eps, method=midpoint)</code> qui impl&#233;mente l'id&#233;e ci-dessus (<code>eps</code> correspond &#224; la tol&#233;rance \( \epsilon \), et la m&#233;thode peut &#234;tre <code>midpoint</code> ou <code>trapeze</code>).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_2" style="font-size: 80%;"></a>
<a href="#exer_2_2" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_2">

<p>
En facilitant les r&#233;ponses &#224; l'ensemble de cet exercice, ainsi qu'en pr&#233;parant l'utilisation facile de l'int&#233;gration adaptative dans les futurs programmes, nous organisons le codage des t&#226;ches a, b et c en un seul fichier, ce qui en fait un module. Le code se lit alors:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> linspace, zeros, sqrt, log
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">trapezoidal</span> <span style="color: #008000; font-weight: bold">import</span> trapezoidal
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">midpoint</span> <span style="color: #008000; font-weight: bold">import</span> midpoint

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">adaptive_integration</span>(f, a, b, eps, method<span style="color: #666666">=</span><span style="color: #BA2121">&#39;midpoint&#39;</span>):
    n_limit <span style="color: #666666">=</span> <span style="color: #666666">1000000</span>   <span style="color: #408080; font-style: italic"># Just a choice (used to avoid inf loop)</span>
    n <span style="color: #666666">=</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">if</span> method <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;trapezoidal&#39;</span>:
        integral_n  <span style="color: #666666">=</span> trapezoidal(f, a, b, n)
        integral_2n <span style="color: #666666">=</span> trapezoidal(f, a, b, <span style="color: #666666">2*</span>n)
        diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n)
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;trapezoidal diff: &#39;</span>, diff
        <span style="color: #008000; font-weight: bold">while</span> (diff <span style="color: #666666">&gt;</span> eps) <span style="color: #AA22FF; font-weight: bold">and</span> (n <span style="color: #666666">&lt;</span> n_limit):
            integral_n  <span style="color: #666666">=</span> trapezoidal(f, a, b, n)
            integral_2n <span style="color: #666666">=</span> trapezoidal(f, a, b, <span style="color: #666666">2*</span>n)
            diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n)
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;trapezoidal diff: &#39;</span>, diff
            n <span style="color: #666666">*=</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">elif</span> method <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;midpoint&#39;</span>:
        integral_n  <span style="color: #666666">=</span> midpoint(f, a, b, n)
        integral_2n <span style="color: #666666">=</span> midpoint(f, a, b, <span style="color: #666666">2*</span>n)
        diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n)
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;midpoint diff: &#39;</span>, diff
        <span style="color: #008000; font-weight: bold">while</span> (diff <span style="color: #666666">&gt;</span> eps) <span style="color: #AA22FF; font-weight: bold">and</span> (n <span style="color: #666666">&lt;</span> n_limit):
            integral_n  <span style="color: #666666">=</span> midpoint(f, a, b, n)
            integral_2n <span style="color: #666666">=</span> midpoint(f, a, b, <span style="color: #666666">2*</span>n)
            diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n)
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;midpoint diff: &#39;</span>, diff
            n <span style="color: #666666">*=</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Error - adaptive integration called with unknown par&#39;</span>
    <span style="color: #408080; font-style: italic"># Now we check if acceptable n was found or not</span>
    <span style="color: #008000; font-weight: bold">if</span> diff <span style="color: #666666">&lt;=</span> eps:   <span style="color: #408080; font-style: italic"># Success</span>
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;The integral computes to: &#39;</span>, integral_2n
        <span style="color: #008000; font-weight: bold">return</span> n
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-</span>n   <span style="color: #408080; font-style: italic"># Return negative n to tell &quot;not found&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">application</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;...Tasks b) and c)&quot;&quot;&quot;</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
        <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(x):
        <span style="color: #008000; font-weight: bold">return</span> sqrt(x)

    <span style="color: #408080; font-style: italic">#eps = 1E-1           # Just switch between these two eps values</span>
    eps <span style="color: #666666">=</span> <span style="color: #666666">1E-10</span>
    <span style="color: #408080; font-style: italic">#a = 0.0</span>
    a <span style="color: #666666">=</span> <span style="color: #666666">0.0</span> <span style="color: #666666">+</span> <span style="color: #666666">0.01</span>;       <span style="color: #408080; font-style: italic"># If we adjust a, sqrt(x) is handled easily</span>
    b <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>
    <span style="color: #408080; font-style: italic"># ...f</span>
    n <span style="color: #666666">=</span> adaptive_integration(f, a, b, eps, <span style="color: #BA2121">&#39;midpoint&#39;</span>)
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Sufficient n is: </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;No n was found in </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> iterations&#39;</span> <span style="color: #666666">%</span> (n_limit)

    n <span style="color: #666666">=</span> adaptive_integration(f, a, b, eps, <span style="color: #BA2121">&#39;trapezoidal&#39;</span>)
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Sufficient n is: </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;No n was found in </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> iterations&#39;</span> <span style="color: #666666">%</span> (n_limit)

    <span style="color: #408080; font-style: italic"># ...g</span>
    n <span style="color: #666666">=</span> adaptive_integration(g, a, b, eps, <span style="color: #BA2121">&#39;midpoint&#39;</span>)
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Sufficient n is: </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;No n was found in </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> iterations&#39;</span> <span style="color: #666666">%</span> (n_limit)

    n <span style="color: #666666">=</span> adaptive_integration(g, a, b, eps, <span style="color: #BA2121">&#39;trapezoidal&#39;</span>)
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Sufficient n is: </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;No n was found in </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> iterations&#39;</span> <span style="color: #666666">%</span> (n_limit)

    <span style="color: #408080; font-style: italic"># Task c, make plot for both midpoint and trapezoidal</span>
    eps <span style="color: #666666">=</span> linspace(<span style="color: #666666">1E-1</span>,<span style="color: #666666">10E-10</span>,<span style="color: #666666">10</span>)
    n_m <span style="color: #666666">=</span> zeros(<span style="color: #008000">len</span>(eps))
    n_t <span style="color: #666666">=</span> zeros(<span style="color: #008000">len</span>(eps))
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(n_m)):
        n_m[i] <span style="color: #666666">=</span> adaptive_integration(g, a, b, eps[i], <span style="color: #BA2121">&#39;midpoint&#39;</span>)
        n_t[i] <span style="color: #666666">=</span> adaptive_integration(g, a, b, eps[i], <span style="color: #BA2121">&#39;trapezoidal&#39;</span>)

    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
    plt<span style="color: #666666">.</span>plot(log(eps),n_m,<span style="color: #BA2121">&#39;b-&#39;</span>,log(eps),n_t,<span style="color: #BA2121">&#39;r-&#39;</span>)
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;log(eps)&#39;</span>)
    plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;n for midpoint (blue) and trapezoidal (red)&#39;</span>)
    plt<span style="color: #666666">.</span>show()
    <span style="color: #008000; font-weight: bold">print</span> n
    <span style="color: #008000; font-weight: bold">print</span> eps

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    application()
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Testez la m&#233;thode sur \( \int_0^2x^2dx \) et \( \int_0^2\sqrt{x}dx \) pour \( \epsilon = 10^{&#8722;1},10^{&#8722;10} \) et notez l'erreur exacte.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_3" style="font-size: 80%;"></a>
<a href="#exer_2_3" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_3">

<p>
Voir le code ci-dessus. Notez que, dans notre code sugg&#233;r&#233;, il est pr&#233;vu que le programmeur bascule entre les deux valeurs epsilon en utilisant des commentaires, c'est-&#224;-dire en ajoutant/supprimant <code>#</code>. Cela peut bien s&#251;r &#234;tre &#233;vit&#233;, si cela est souhaitable, en demandant &#224; l'utilisateur d'entrer un valeur d'epsilon.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Faites un trac&#233; de \( n \) en fonction de \( \epsilon \in [10^{-1}, 10^{-10}] \) pour \( \int_0^2\sqrt{x}dx \). Utilisez l'&#233;chelle logarithmique pour \( \epsilon \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_4" style="font-size: 80%;"></a>
<a href="#exer_2_4" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_4">

<p>
La figure 14 montre que plus la valeur d'epsilon est stricte, plus la diff&#233;rence entre les m&#233;thodes du point milieu et des trap&#232;zes est grande. Pour une valeur donn&#233;e pour epsilon, la m&#233;thode du point m&#233;dian se situe dans la tol&#233;rance avec moins d'intervalles (valeur inf&#233;rieure de \( n \)) que la m&#233;thode des trap&#232;zes. Il faut s'y attendre, car la m&#233;thode du point milieu est un peu plus pr&#233;cise que la m&#233;thode des trap&#232;zes.

<p>
Une fa&#231;on de produire ce trac&#233; est d'utiliser les lignes de code incluses &#224; la fin de <code>integration_adaptive.py</code> (voir ci-dessus).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec2" class="anchor">Remarks </h3>

<p>
Le type de m&#233;thode explor&#233; dans cet exercice est appel&#233; <em>adaptatif</em>, car il essaie d'adapter la valeur de n pour r&#233;pondre &#224; un crit&#232;re d'erreur donn&#233;. La vraie erreur peut tr&#232;s rarement &#234;tre calcul&#233;e (car nous ne connaissons pas la r&#233;ponse exacte au probl&#232;me de calcul), il faut donc trouver d'autres indicateurs de l'erreur, comme celui ici o&#249; les changements de la valeur int&#233;grale, comme le nombre d'intervalles est doubl&#233;, est pris pour refl&#233;ter l'erreur.

<p>
<!-- --- end exercise --- -->

<p>
<!-- !split -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec3" class="anchor">Exercise 3: Int&#233;gration de x &#233;lev&#233; &#224; x </h2>

<p>
Consid&#233;rons l'int&#233;grale
$$
\begin{equation*}
I = \int_0^2 x^x\,dx\thinspace .
\end{equation*}
$$

L'int&#233;grande \( x^x \) n'a pas de primitive qui peut &#234;tre exprim&#233; en termes de fonctions standard (visitez <a href="http://wolframalpha.com" target="_self"><tt>http://wolframalpha.com</tt></a> et tapez <code>integral x^x dx from 0 to 2</code> pour vous convaincre que notre affirmation est juste. Notez que Wolfram alpha vous donne une r&#233;ponse, mais cette r&#233;ponse est une approximation, elle n'est pas <em>exacte</em>. C'est parce que Wolfram alpha utilise &#233;galement des m&#233;thodes num&#233;riques pour arriver &#224; la r&#233;ponse, comme vous le ferez dans cet exercice). Par cons&#233;quent, nous sommes oblig&#233;s de calculer l'int&#233;grale par des m&#233;thodes num&#233;riques. Calculez un r&#233;sultat compos&#233; de quatre chiffres.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_1" style="font-size: 80%;"></a>
<a href="#exer_3_1" data-toggle="collapse">
<b>Indication.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_1">

<p>
Utilisez des id&#233;es de l'exercice <a href="#ex:adaptatif">Exercise 2: Int&#233;gration adaptative</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_2" style="font-size: 80%;"></a>
<a href="#exer_3_2" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_2">

<p>
Lorsque la fonction <code>integration_adaptive</code> est disponible, le code peut s'&#233;crire:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">integration_adaptive</span> <span style="color: #008000; font-weight: bold">import</span> integration_adaptive

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**</span>x

eps <span style="color: #666666">=</span> <span style="color: #666666">1E-4</span>
a <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;  b <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>

<span style="color: #408080; font-style: italic"># Choose midpoint method</span>
n <span style="color: #666666">=</span> integration_adaptive(f, a, b, eps, <span style="color: #BA2121">&#39;midpoint&#39;</span>)
<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Sufficient n is: </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n)
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #408080; font-style: italic"># The negative n is returned to signal that the upper limit of n</span>
    <span style="color: #408080; font-style: italic"># was passed</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;No n was found in </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> iterations&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">abs</span>(n))
</pre></div>
<p>
N'oubliez pas que <code>integration_adaptive</code> affiche l'int&#233;grale calcul&#233;e, donc aucun effort &#224; cet &#233;gard n'est requis ici.

<p>
L'ex&#233;cution du programme donne une impression &#224; l'&#233;cran montrant comment la diff&#233;rence devient de plus en plus petite &#224; chaque fois. Les deux derni&#232;res lignes de l'impression se lisent comme suit:
<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>The integral computes to: 2.83384395958
Sufficient n is: 256
</pre></div>
<p>
La valeur calcul&#233;e peut &#234;tre compar&#233;e &#224; ce que donne Wolfram alpha. N'oubliez pas qu'&#233;tant donn&#233; que nous n'avons pas calcul&#233; l'erreur exacte, nous ne pouvons garantir que le "r&#233;sultat est correct &#224; quatre chiffres". Cependant, nous avons des raisons de croire que nous "sommes proches". Typiquement, lorsque l'on sait que la mesure d'erreur utilis&#233;e n'est pas pr&#233;cise, la tol&#233;rance est rendue plus stricte.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 2020, Ahmed Ammar. Released under CC Attribution 4.0 license
</center>


</body>
</html>
    

